<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Prompt Enhancer</title>
  <link rel="stylesheet" href="style.css">

  <!-- Google Analytics tracking -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-D5NMHFTQDK"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());

    gtag('config', 'G-D5NMHFTQDK');
  </script>
</head>

<body>

  <!-- Main container -->
  <div class="container">
    <div class="main-content">
      <!-- Tool content section -->
        <div id="tool" class="content">
          <div id="desktop">
          <div id="menu-bar">
            <button type="button" id="menu-start" class="menu-start" aria-haspopup="true" aria-expanded="false">
              <span class="menu-glyph" aria-hidden="true">
                <span class="slash slash-red">/</span><span class="slash slash-yellow">/</span><span class="slash slash-blue">/</span>
              </span>
            </button>
            <div id="menu-dropdown" class="menu-dropdown" role="menu" aria-hidden="true">
              <div class="menu-item" data-window="prompts" role="menuitem">
                <span class="menu-icon icon-prompts" aria-hidden="true"></span>
                Prompt Enhancer
              </div>
              <div class="menu-separator" role="separator"></div>
              <div class="menu-item" data-window="audio" role="menuitem">
                <span class="menu-icon icon-audio" aria-hidden="true"></span>
                Audio Interpolator
              </div>
              <div class="menu-separator" role="separator"></div>
              <div class="menu-item" data-window="diskrot" role="menuitem">
                <span class="menu-icon icon-diskrot" aria-hidden="true"></span>
                diskrot
              </div>
              <div class="menu-separator" role="separator"></div>
              <div class="menu-item" data-window="about" role="menuitem">
                <span class="menu-icon icon-about" aria-hidden="true"></span>
                About
              </div>
            </div>
            <div id="taskbar" class="taskbar"></div>
          </div>
          <div id="window-area">
            <div id="window-prompts-template" class="window-shell box-shell app-window prompt-window window-template" data-template="prompts">
              <div class="box-header window-header">
                <span class="box-title" aria-label="Prompt Enhancer window title">Prompt Enhancer</span>
                <div class="button-col">
                  <button type="button" class="toggle-button icon-button hide-button collapse-toggle" title="Minimize" data-expanded="-" data-collapsed="+">-</button>
                  <button type="button" class="toggle-button icon-button maximize-toggle" title="Maximize">□</button>
                  <button type="button" class="delete-button icon-button remove-box" title="Close">X</button>
                </div>
              </div>
              <div class="box-body">
                <div class="prompt-menu">
                  <button type="button" class="prompt-menu-start" aria-haspopup="true" aria-expanded="false" data-help="Open the file menu." data-help-detail="Use the file menu to open saved prompt enhancer files or save the current state as a JSON download.">
                    <span class="prompt-menu-glyph" aria-hidden="true">///</span>
                    <span class="prompt-menu-label">file</span>
                  </button>
                  <div class="prompt-menu-dropdown" role="menu" aria-hidden="true">
                    <div class="prompt-menu-item" data-action="open" role="menuitem" data-help="Load a saved prompt enhancer JSON file." data-help-detail="Open a saved prompt enhancer file. The prompt window title updates to the file name and any saved presets or settings load with it.">Open</div>
                    <div class="prompt-menu-item" data-action="save" role="menuitem" data-help="Save using the current file name, or prompt for one if none is set." data-help-detail="Save the current prompt enhancer state. If the window already has a name, it downloads immediately; if not, it will prompt for a name first.">Save</div>
                    <div class="prompt-menu-item" data-action="save-as" role="menuitem" data-help="Choose a new file name and save the current prompt enhancer state." data-help-detail="Always prompt for a new file name, download the JSON under that name (auto-adding .json), and update the window title.">Save As</div>
                  </div>
                  <div class="prompt-menu-spacer" aria-hidden="true"></div>
                  <button type="button" class="help-toggle" aria-pressed="false" data-help="Toggle help mode." data-help-detail="When help mode is on, clicking any control shows what it does instead of activating it. Click Help again or press Escape to exit.">Help</button>
                </div>
                <div class="prompt-body" data-help="Prompt workspace." data-help-detail="This is the main canvas where mixes, strings, and variables live. Use the buttons and boxes here to build and generate your prompt.">
                  <button type="button" class="holo-generate generate-button" data-help="Generate the current mix output." data-help-detail="Runs the mixing engine for every mix and string, applying randomization, length modes, and first-chunk behavior so all output panels update.">GENERATE MIX</button>
                  <input type="file" class="load-mix-file" accept="application/json" style="display:none">
                  <div class="mix-root"></div>
                  <div class="empty-state">
                    <div class="empty-state-text">No mixes yet.</div>
                    <button type="button" class="add-button add-empty-mix" data-help="Add a new top-level mix." data-help-detail="Creates a fresh mix at the root so you can start building a new prompt structure.">+ Add Mix</button>
                  </div>
                  <div class="root-actions">
                    <button type="button" class="add-button add-root-mix" data-help="Add a new top-level mix." data-help-detail="Adds another mix at the root level alongside existing mixes.">+ Add Mix</button>
                  </div>
                </div>
                <div class="help-overlay is-hidden" aria-hidden="true"></div>
                <div class="help-popover is-hidden" role="dialog" aria-hidden="true" aria-live="polite">
                  <div class="help-popover-header">
                    <span class="help-popover-title">Help</span>
                    <button type="button" class="help-close" aria-label="Close help" data-help="Close this help card." data-help-detail="Hides the current help card but leaves Help mode on.">×</button>
                  </div>
                  <div class="help-popover-short"></div>
                  <div class="help-popover-detail"></div>
                </div>

                <template id="mix-box-template">
                  <div class="mix-wrapper">
                    <div class="mix-box box-shell" data-box-type="mix">
                      <div class="box-header">
                        <input type="text" class="box-title" value="Mix" data-help="Rename this mix." data-help-detail="Change the mix name for clarity. Names are used in variable pickers and help identify boxes.">
                        <div class="button-col">
                          <button type="button" class="copy-button icon-button copy-output" title="Copy output" data-help="Copy the current mix output to the clipboard." data-help-detail="Copies the generated mix output shown below. Use this after Generate to quickly paste the result elsewhere.">&#128203;</button>
                          <button type="button" class="toggle-button icon-button color-toggle" title="Color" data-help="Open the color panel to pick a custom color or preset." data-help-detail="Choose Auto, a preset, or a custom color to visually tag this mix. Saved presets can be reused across boxes.">&#127912;</button>
                          <button type="button" class="toggle-button icon-button random-button random-toggle" title="Randomize list order" data-help="Randomize mix order each cycle." data-help-detail="When on, the mix cycles through child lists in a shuffled order each pass. Turn off to keep a stable, predictable order.">&#127922;</button>
                          <button type="button" class="toggle-button icon-button hide-button collapse-toggle" title="Collapse" data-expanded="-" data-collapsed="+" data-help="Collapse or expand this mix." data-help-detail="Collapsing hides the mix body so you can focus on other sections; expand to edit again.">-</button>
                          <button type="button" class="delete-button icon-button remove-box" title="Remove" data-help="Remove this mix." data-help-detail="Deletes this mix and all of its children from the prompt structure.">X</button>
                        </div>
                      </div>
                      <div class="box-body">
                        <div class="mix-output" data-help="Output generated for this mix." data-help-detail="Shows the current mixed output after Generate. It reflects randomization, length mode, and rechunking settings for this mix.">
                          <div class="label-row">
                            <label>Output</label>
                          </div>
                          <div class="input-row">
                            <pre class="mix-output-text">output will appear here</pre>
                          </div>
                        </div>
                        <div class="color-controls is-hidden">
                          <div class="label-row">
                            <label>Color</label>
                          </div>
                          <div class="input-row color-row">
                            <select class="color-preset-select" data-help="Select Auto, a preset, or Custom to set the box color." data-help-detail="Auto uses the default palette. Presets apply saved colors. Custom lets you pick any color."></select>
                            <input type="color" class="color-custom-input" value="#f2aa48" aria-label="Custom color" data-help="Pick any color to apply to this box." data-help-detail="Choose any color to override the auto palette for this specific box.">
                          </div>
                          <div class="input-row color-row">
                            <input type="text" class="color-preset-name" placeholder="Preset name" data-help="Name a custom color preset so it can be reused." data-help-detail="Enter a label for your custom color so it shows up in the preset list.">
                            <button type="button" class="add-button save-color-preset" data-help="Save the current custom color as a named preset." data-help-detail="Adds this custom color to your saved preset list for reuse across boxes.">Save Preset</button>
                          </div>
                        </div>
                        <div class="mix-controls">
                          <div class="control-block">
                            <label>Rechunk Delimiter</label>
                            <select class="delimiter-select" data-help="Choose how the mix output is split into chunks." data-help-detail="Select a delimiter to define chunk boundaries when this mix re-chunks its output. Use Custom to define your own delimiter.">
                              <option value="whitespace" selected>Whitespace (default)</option>
                              <option value="comma">Comma (,)</option>
                              <option value="semicolon">Semicolon (;)</option>
                              <option value="pipe">Pipe (|)</option>
                              <option value="newline">Newline</option>
                              <option value="tab">Tab</option>
                              <option value="sentence">Sentence Punctuation (.,;:!? + newline)</option>
                              <option value="custom">Custom...</option>
                            </select>
                            <div class="input-row delimiter-custom-row" style="display:none">
                              <input type="text" class="delimiter-custom" placeholder="Custom delimiter (use \n for newline)" data-help="Enter a custom delimiter." data-help-detail="Type the exact characters used to split chunks. Use \\n for newlines and \\t for tabs.">
                            </div>
                          </div>
                          <div class="control-block">
                            <label>Chunk Size / Preserve</label>
                            <select class="delimiter-size" data-help="Set the chunk size or preserve child chunks." data-help-detail="Choose Preserve chunks to pass child chunks through unchanged. Otherwise set a number to group that many delimiters into each output chunk.">
                              <option value="preserve" selected>Preserve chunks</option>
                              <option value="1">1</option>
                              <option value="2">2</option>
                              <option value="3">3</option>
                              <option value="4">4</option>
                              <option value="5">5</option>
                              <option value="6">6</option>
                              <option value="7">7</option>
                              <option value="8">8</option>
                              <option value="9">9</option>
                              <option value="10">10</option>
                            </select>
                          </div>
                          <div class="control-block">
                            <label>First Chunk Behavior</label>
                            <select class="first-chunk-select" data-help="Choose how the first chunk is cut." data-help-detail="Size X keeps fixed chunk sizes. Between 1 - X randomizes the first chunk size to offset repeats. Size X, random start location rotates the prompt before grouping.">
                              <option value="size">Size X</option>
                              <option value="between" selected>Between 1 - X</option>
                              <option value="random-start">Size X, random start location</option>
                            </select>
                          </div>
                          <div class="control-block">
                            <label>Length Limit</label>
                            <input type="number" class="length-input" value="1000" min="1" data-help="Maximum total output length unless Exactly Once is enabled." data-help-detail="Caps how many characters this mix can emit. In Exactly Once mode, the limit is ignored so each chunk appears once.">
                          </div>
                          <div class="control-block toggle-block">
                            <label>Length Mode</label>
                            <select class="length-mode" data-help="Choose how length limits are enforced." data-help-detail="Split Final Chunk trims the last chunk to hit the limit. Delete Final Chunk drops the chunk that would overflow. Exactly Once outputs each chunk one time and disables the length limit.">
                              <option value="exact">Split Final Chunk</option>
                              <option value="exact-once" selected>Exactly Once</option>
                              <option value="allow">Delete Final Chunk</option>
                            </select>
                          </div>
                        </div>
                        <div class="mix-children"></div>
                        <div class="mix-actions">
                          <button type="button" class="add-button add-chunk-child" data-help="Add a string to this mix." data-help-detail="Adds a new string box as a child of this mix so its chunks can be included in the output.">+ Add String</button>
                          <button type="button" class="add-button add-mix-child" data-help="Add a nested mix to this mix." data-help-detail="Adds a child mix so you can build multi-level prompt structures and re-chunk submixes.">+ Add Mix</button>
                          <button type="button" class="add-button add-variable-child" data-help="Add a variable reference." data-help-detail="Adds a variable box that points to another mix or string and injects its chunks here.">+ Add Variable</button>
                        </div>
                      </div>
                    </div>
                  </div>
                </template>

                <template id="chunk-box-template">
                  <div class="chunk-wrapper">
                    <div class="chunk-box box-shell" data-box-type="chunk">
                      <div class="box-header">
                        <input type="text" class="box-title" value="String" aria-label="String title" data-help="Rename this string." data-help-detail="Change the string name for clarity. Names are used in variable pickers and help identify boxes.">
                        <div class="button-col">
                          <button type="button" class="copy-button icon-button copy-input" title="Copy string" data-help="Copy this string’s output to the clipboard." data-help-detail="Copies the generated output for this string (including randomization and length mode), not the raw input text.">&#128203;</button>
                          <button type="button" class="toggle-button icon-button color-toggle" title="Color" data-help="Open the color panel to pick a custom color or preset." data-help-detail="Choose Auto, a preset, or a custom color to visually tag this string. Saved presets can be reused across boxes.">&#127912;</button>
                          <button type="button" class="toggle-button icon-button random-button random-toggle" title="Randomize chunks" data-help="Randomize chunk order." data-help-detail="When on, the chunks in this string are shuffled each cycle before applying length rules.">&#127922;</button>
                          <button type="button" class="toggle-button icon-button hide-button collapse-toggle" title="Collapse" data-expanded="-" data-collapsed="+" data-help="Collapse or expand this string." data-help-detail="Collapsing hides the string body so you can focus on other sections; expand to edit again.">-</button>
                          <button type="button" class="delete-button icon-button remove-box" title="Remove" data-help="Remove this string." data-help-detail="Deletes this string box and removes its chunks from any mixes that reference it.">X</button>
                        </div>
                      </div>
                      <div class="box-body">
                        <div class="input-row">
                          <textarea class="chunk-input" rows="3" placeholder="Enter string" data-help="Enter the source text for this string." data-help-detail="This text is split into chunks using the delimiter and size settings below. The Output section shows the processed result."></textarea>
                        </div>
                        <div class="chunk-output" data-help="Output generated for this string." data-help-detail="Shows the processed output after chunking, randomization, and length settings are applied.">
                          <div class="label-row">
                            <label>Output</label>
                          </div>
                          <div class="input-row">
                            <pre class="chunk-output-text">output will appear here</pre>
                          </div>
                        </div>
                        <div class="color-controls is-hidden">
                          <div class="label-row">
                            <label>Color</label>
                          </div>
                          <div class="input-row color-row">
                            <select class="color-preset-select" data-help="Select Auto, a preset, or Custom to set the box color." data-help-detail="Auto uses the default palette. Presets apply saved colors. Custom lets you pick any color."></select>
                            <input type="color" class="color-custom-input" value="#ec78d6" aria-label="Custom color" data-help="Pick any color to apply to this box." data-help-detail="Choose any color to override the auto palette for this specific box.">
                          </div>
                          <div class="input-row color-row">
                            <input type="text" class="color-preset-name" placeholder="Preset name" data-help="Name a custom color preset so it can be reused." data-help-detail="Enter a label for your custom color so it shows up in the preset list.">
                            <button type="button" class="add-button save-color-preset" data-help="Save the current custom color as a named preset." data-help-detail="Adds this custom color to your saved preset list for reuse across boxes.">Save Preset</button>
                          </div>
                        </div>
                        <div class="chunk-controls">
                          <div class="control-block">
                            <label>Delimiter</label>
                            <select class="delimiter-select" data-help="Choose how the string is split into chunks." data-help-detail="Select a delimiter to define chunk boundaries. Use Custom to define your own delimiter characters.">
                              <option value="whitespace" selected>Whitespace (default)</option>
                              <option value="comma">Comma (,)</option>
                              <option value="semicolon">Semicolon (;)</option>
                              <option value="pipe">Pipe (|)</option>
                              <option value="newline">Newline</option>
                              <option value="tab">Tab</option>
                              <option value="sentence">Sentence Punctuation (.,;:!? + newline)</option>
                              <option value="custom">Custom...</option>
                            </select>
                            <div class="input-row delimiter-custom-row" style="display:none">
                              <input type="text" class="delimiter-custom" placeholder="Custom delimiter (use \n for newline)" data-help="Enter a custom delimiter." data-help-detail="Type the exact characters used to split chunks. Use \\n for newlines and \\t for tabs.">
                            </div>
                          </div>
                          <div class="control-block">
                            <label>Chunk Size</label>
                            <select class="delimiter-size" data-help="Set how many delimiter units form each chunk." data-help-detail="A size of 1 keeps every delimiter split as its own chunk; larger sizes group multiple delimiter units together.">
                              <option value="1">1</option>
                              <option value="2">2</option>
                              <option value="3">3</option>
                              <option value="4" selected>4</option>
                              <option value="5">5</option>
                              <option value="6">6</option>
                              <option value="7">7</option>
                              <option value="8">8</option>
                              <option value="9">9</option>
                              <option value="10">10</option>
                            </select>
                          </div>
                          <div class="control-block">
                            <label>First Chunk Behavior</label>
                            <select class="first-chunk-select" data-help="Choose how the first chunk is cut." data-help-detail="Size X keeps fixed chunk sizes. Between 1 - X randomizes the first chunk size to offset repeats. Size X, random start location rotates the prompt before grouping.">
                              <option value="size">Size X</option>
                              <option value="between" selected>Between 1 - X</option>
                              <option value="random-start">Size X, random start location</option>
                            </select>
                          </div>
                          <div class="control-block">
                            <label>Length Limit</label>
                            <input type="number" class="length-input" value="1000" min="1" data-help="Maximum total output length unless Exactly Once is enabled." data-help-detail="Caps how many characters this string can emit. In Exactly Once mode, the limit is ignored so each chunk appears once.">
                          </div>
                          <div class="control-block toggle-block">
                            <label>Length Mode</label>
                            <select class="length-mode" data-help="Choose how length limits are enforced." data-help-detail="Split Final Chunk trims the last chunk to hit the limit. Delete Final Chunk drops the chunk that would overflow. Exactly Once outputs each chunk one time and disables the length limit.">
                              <option value="exact">Split Final Chunk</option>
                              <option value="exact-once" selected>Exactly Once</option>
                              <option value="allow">Delete Final Chunk</option>
                            </select>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </template>

                <template id="variable-box-template">
                  <div class="variable-wrapper">
                    <div class="variable-box box-shell" data-box-type="variable">
                      <div class="box-header">
                        <span class="box-title">Variable</span>
                        <div class="button-col">
                          <button type="button" class="toggle-button icon-button hide-button collapse-toggle" title="Collapse" data-expanded="-" data-collapsed="+" data-help="Collapse or expand this variable." data-help-detail="Collapsing hides the variable settings so you can focus on other sections; expand to edit again.">-</button>
                          <button type="button" class="delete-button icon-button remove-box" title="Remove" data-help="Remove this variable." data-help-detail="Deletes this variable reference from the mix.">X</button>
                        </div>
                      </div>
                      <div class="box-body">
                        <div class="control-block">
                          <label>Source</label>
                          <select class="variable-select" data-help="Choose which mix or string this variable points to." data-help-detail="Variables re-use another box’s chunks in this mix. Select the source box to pull its output here.">
                            <option value="" selected>Select a mix or string...</option>
                          </select>
                        </div>
                      </div>
                    </div>
                  </div>
                </template>
              </div>
              <div class="resize-handle" aria-hidden="true"></div>
            </div>

            <div id="window-about-template" class="window-shell box-shell app-window about-window window-template" data-template="about">
              <div class="box-header window-header">
                <span class="box-title" aria-label="About window title">About</span>
                <div class="button-col">
                  <button type="button" class="toggle-button icon-button hide-button collapse-toggle" title="Minimize" data-expanded="-" data-collapsed="+">-</button>
                  <button type="button" class="toggle-button icon-button maximize-toggle" title="Maximize">□</button>
                  <button type="button" class="delete-button icon-button remove-box" title="Close">X</button>
                </div>
              </div>
              <div class="box-body">
                <div class="input-group section-about about-card">
                  <div class="label-row">
                    <label>tools by daniel yosef stilman///yolkhead</label>
                  </div>
                  <p class="about-text">GitHub: <a class="about-link" href="https://github.com/daniel-stilman" target="_blank" rel="noopener noreferrer">github.com/daniel-stilman</a></p>
                  <p class="about-text">Linktree: <a class="about-link" href="https://linktr.ee/yolkhead" target="_blank" rel="noopener noreferrer">linktr.ee/yolkhead</a></p>
                  <p class="about-text">Diskrot: <a class="about-link" href="https://diskrot.com/@yolkhead" target="_blank" rel="noopener noreferrer">diskrot.com/@yolkhead</a></p>
                </div>
              </div>
              <div class="resize-handle" aria-hidden="true"></div>
            </div>

            <div id="window-audio-template" class="window-shell box-shell app-window audio-window window-template" data-template="audio">
              <div class="box-header window-header">
                <span class="box-title" aria-label="Audio Interpolator window title">Audio Interpolator</span>
                <div class="button-col">
                  <button type="button" class="toggle-button icon-button hide-button collapse-toggle" title="Minimize" data-expanded="-" data-collapsed="+">-</button>
                  <button type="button" class="toggle-button icon-button maximize-toggle" title="Maximize">□</button>
                  <button type="button" class="delete-button icon-button remove-box" title="Close">X</button>
                </div>
              </div>
              <div class="box-body">
                <iframe class="audio-frame" title="Audio Interpolator" src="https://diskrot.com/audio-interpolator/index.html"></iframe>
              </div>
              <div class="resize-handle" aria-hidden="true"></div>
            </div>

            <div id="window-diskrot-template" class="window-shell box-shell app-window diskrot-window window-template" data-template="diskrot">
              <div class="box-header window-header">
                <span class="box-title" aria-label="Diskrot window title">///diskrot</span>
                <div class="button-col">
                  <button type="button" class="toggle-button icon-button hide-button collapse-toggle" title="Minimize" data-expanded="-" data-collapsed="+">-</button>
                  <button type="button" class="toggle-button icon-button maximize-toggle" title="Maximize">□</button>
                  <button type="button" class="delete-button icon-button remove-box" title="Close">X</button>
                </div>
              </div>
              <div class="box-body">
                <iframe class="diskrot-frame" title="Diskrot" src="https://www.diskrot.com"></iframe>
              </div>
              <div class="resize-handle" aria-hidden="true"></div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- External script loading order is important -->
  <!-- Load list data files first -->
  <script src="default_list.js"></script>
  <!-- Then load main application logic -->
  <script src="script.js"></script>
</body>

</html>
